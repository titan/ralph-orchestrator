# Ralph Orchestrator Configuration for Claude
# v2 nested format - optimized for Claude Code CLI

# Event loop settings
event_loop:
  completion_promise: "LOOP_COMPLETE"
  max_iterations: 100
  max_runtime_seconds: 14400      # 4 hours
  max_consecutive_failures: 5

# CLI backend settings
cli:
  backend: "kiro"
  prompt_mode: "arg"              # Pass prompt as CLI argument
  pty_mode: false                 # Set true for rich terminal UI
  pty_interactive: true           # Forward keystrokes in PTY mode
  idle_timeout_secs: 30           # Kill after 30s of inactivity

# Core behaviors (always injected into prompts)
core:
  specs_dir: "./specs/"
  guardrails:
    - "Fresh context each iteration - save learnings to memories for next time"
    - "Don't assume 'not implemented' - search first"
    - "Verification is mandatory - tests/typecheck/lint must pass"

hats:
  builder:
    name: "Builder"
    description: "Implements code, creates files, runs tests. Does the actual work."
    triggers: ["build.task"]
    publishes: ["build.done", "build.blocked"]
    instructions: |
      ## WORKFLOW

      You are Builder. Your job is to IMPLEMENT - write code, create files, run tests.

      1. Read the build.task event payload - that's your task
      2. IMPLEMENT: Create files, write code, run commands
      3. VERIFY: Run tests/builds to confirm it works
      4. COMPLETE: Emit build.done when verified, or build.blocked if stuck

      RULES:
      - Do the actual work - don't just plan or delegate
      - Never emit build.task (that's for coordination, not you)

